{% load static %}
<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">

	<!-- название стриницы -->
	<title>GNB</title>
	<link rel="stylesheet" href="{% static '/css/index.css' %}" type="text/css">
	<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Oswald:400,300" type="text/css">

	<!--[if lt IE 9]>
	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
</head>
<body>
    <!-- Верхняя панель -->
    <header class="top-bar">
        <div class="left">
            <button onclick="window.location.href='{% url 'profil' %}'">Построить профиль</button>
        </div>
        <div class="right">
            <button id="loginBtn">Вход / Регистрация</button>
        </div>
    </header>

    <!-- Модальное окно -->
    <div id="loginModal" style="display:none; position:fixed; top:20%; left:30%; background:white; border:1px solid #ccc; padding:20px;">
        <h3>Вход / Регистрация</h3>
        <form method="post" action="{% url 'login' %}">
            {% csrf_token %}
            <label>Имя пользователя:</label>
            <input type="text" name="username">
            <label>Пароль:</label>
            <input type="password" name="password">
            <button type="submit">Войти</button>
            <button type="button" onclick="document.getElementById('loginModal').style.display='none'">Закрыть</button>
        </form>
    </div>
    <!-- Скрипт модального окна -->
    <script>
        const modal = document.getElementById("loginModal");
        const btn = document.getElementById("loginBtn");
        const span = document.getElementById("closeModal");

        btn.onclick = () => modal.style.display = "block";
        span.onclick = () => modal.style.display = "none";
        window.onclick = (event) => {
            if (event.target == modal) modal.style.display = "none";
        }
    </script>
    <!-- Добавить строку поиска -->
    <form name="search" action="{% url 'search' %}" method="GET">
        <input type="text" name="q" placeholder="Поиск..."><button type="submit">GO</button>
    </form>

    <!-- Меню -->
    <section>
        <h2>Загрузка документов</h2>
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ project_form.as_p }}
            <button type="submit" name="upload_project">Загрузить проект</button>
        </form>

        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ attachment_form.as_p }}
            <button type="submit" name="upload_attachment">Загрузить привязку</button>
        </form>

        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            {{ protocol_form.as_p }}
            <button type="submit" name="upload_protocol">Загрузить протокол</button>
        </form>
    </section>

    <section>
        <h2>Документы</h2>

        <h3>Проекты</h3>
        <ul>
            {% for project in projects %}
                <li>{{ project.address }} — {{ project.description }} —
                    <a href="{{ project.file.url }}" target="_blank">Скачать</a>
                </li>
            {% empty %}
                <li>Нет загруженных проектов</li>
            {% endfor %}
        </ul>

        <h3>Привязки</h3>
        <ul>
            {% for a in attachments %}
                <li>{{ a.address }} — {{ a.description }} —
                    <a href="{{ a.file.url }}" target="_blank">Скачать</a>
                </li>
            {% empty %}
                <li>Нет загруженных привязок</li>
            {% endfor %}
        </ul>

        <h3>Профили (графики)</h3>
        <ul>
            {% for p in profiles %}
                <li>{{ p.address }} — {{ p.description }} —
                    <a href="{{ p.image.url }}" target="_blank">Открыть</a>
                </li>
            {% empty %}
                <li>Нет профилей</li>
            {% endfor %}
        </ul>

        <h3>Протоколы бурения</h3>
        <ul>
            {% for pr in protocols %}
                <li>{{ pr.address }} — {{ pr.description }} —
                    <a href="{{ pr.file.url }}" target="_blank">Скачать</a>
                </li>
            {% empty %}
                <li>Нет протоколов</li>
            {% endfor %}
        </ul>
    </section>

    <!-- templates/index.html -->

    <h2>Сохранённые протоколы</h2>
    <table>
      <tr>
        <th>Адрес</th>
        <th>Описание</th>
        <th>Система бурения</th>
        <th>Длина</th>
        <th>Расширение</th>
        <th>Дата</th>
      </tr>
      {% for p in protocols %}
      <tr>
        <td>{{ p.address }}</td>
        <td>{{ p.description }}</td>
        <td>{{ p.drilling_system }}</td>
        <td>{{ p.total_length }} м</td>
        <td>{{ p.expansion_sequence }}</td>
        <td>{{ p.created_at|date:"d.m.Y" }}</td>
      </tr>
      {% empty %}
      <tr><td colspan="6">Нет сохранённых протоколов</td></tr>
      {% endfor %}
    </table>

    <!-- добавление футера внизу -->
	<footer>
		<div id="footer">
		 <div id="produced"></div>
		 <h3>PRODUCED BY</h3>
		 <p>
			 Podporina Margarita Vladimirovna
		 </p>
		 <div id="footer-logo">
			 <a href="/"><img src="{% static '/img/logo.png' %}" alt=""></a>
			 <p>Copyright © 2025 GNB. For HDD creation</p>
		 </div>
		</div>
	</footer>
</body>
</html>